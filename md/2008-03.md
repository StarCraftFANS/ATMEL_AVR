[2008-02](2008-02.md) 

- - - -

#### 久々に [W32_term](W32_term.md)  を更新
- 実はＡＶＲ側のボーレート設定が行われていなかった問題をＦＩＸ。
- アップロード、ログ機能を直した。

<!-- dummy comment line for breaking list -->

- - - -

#### [W32_term](W32_term.md)  経由で、[Ｈ８／３６９４Ｆ](Ｈ８／３６９４Ｆ.md) のファーム書き換えに成功した。
- h8write.exeがそのまま使える。便利。

<!-- dummy comment line for breaking list -->

- - - -

#### ＡＴＴｉｎｙ２３１３を使用したＵＳＢｔｏシリアル変換器のメリット。
市販品の変換ケーブルとの違いについて考察した。
- （１）安い
    - ＡＴＴｉｎｙ２３１３は大量購入すると９０円、しなくても１００円。
    - あとは１２ＭＨｚの水晶（５０円くらい）とＵＳＢコネクタが高いだけであとはタダ同然の部品で作れる。
- （２）相手側がＨ８やＺ８０のようなマイコンだった場合、ＭＡＸ２３２が不要。
    - Ｔｘ、Ｒｘをクロス直結するだけで済むので便利。
    - ＲＴＳとかＤＴＲとかの処理がいらない。そもそもそんな信号使ってない。
- （３）＋５ＶがＵＳＢから貰えるので、そのままマイコンに供給したり出来る。
    - 別電源がある場合はぜんぜん関係ない。
- （４）ボーレートの設定自由度が高い。
    - W32_termがボーレート設定値から分周比を計算してくれるので ６００くらいから３８４００くらいの間であれば、適当な数値でもＯＫ。
    - Ｈ８側モニターのボーレート設定値が３８４００だったのだが、クロックが指定と異なっていても（１６ＭＨｚ指定なのに、実際の水晶は２０ＭＨｚだったりとか）逆算したレートを指定できる。
- （５）必要があればＡＶＲの余ったピンを自分でコントロールしていろいろできる。
    - ただしプログラムも自分で書くしかないが・・・。

<!-- dummy comment line for breaking list -->

逆にデメリットは
- （１）３８４００以上は文字落ちする。
- （２）ＬｏｗＳｐｅｅｄデバイスなのでハンディがある。（なぜかＨｉｇｈＳｐｅｅｄハブがないＵＨＣＩではやや遅いとかね）

<!-- dummy comment line for breaking list -->

**とりあえず９６００ボーあれば事足りるＨ８ｗｒｉｔｅの実行には支障はなかった模様**

- - - -
#### ＡＴＴｉｎｙ２３１３を使用したＵＳＢｔｏシリアル変換器は、どこまで使えるのか？
たまたま接続したＨ８／３６９４Ｆのモニターにはボーレート設定コマンドがあるので、上限をテストしてみた。
- ただし、クロックが２０ＭＨｚ駆動なので、（２０/１６）倍される。

<!-- dummy comment line for breaking list -->

|Ｈ８側の設定レート|実際の速度レート|マザー直結ＵＳＢ|ＨＳハブ挟みあり|
|19200 bps設定のつもり|本当は24000 bit per sec|ＯＫ|ＯＫ|
|38400 bps設定のつもり|本当は48000 bit per sec|文字落ちする((１６文字に２文字くらい落ちる))|ＯＫ|
|57600 bps設定のつもり|本当は72000 bit per sec|文字落ちする|文字落ちする|

３８４００がギリギリっす。
- 本当の３８４００で試したい・・・

<!-- dummy comment line for breaking list -->

試してみた。
- 実際、Ｈ８／ｔｉｎｙに接続していろいろ試してみたが、２８８００くらいが限界。
- ３８４００でも、落ちないときは落ちないが、長時間ダンプとかすると落ちるので駄目。
- Ｈ８／ｔｉｎｙで接続するときは１９２００で行なっている。

